@using Handicraft_Shop.Models;
@{
    ViewBag.Title = "KhachHangXemGioHang";
    Layout = "~/Views/Shared/KhachHangLayout.cshtml";
}

<div class="container mt-5">
    <h2 class="text-center mb-4">Thông Tin Giỏ Hàng</h2>

    @if (TempData["Message"] != null)
    {
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
            <strong>Thông báo:</strong> @TempData["Message"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <table class="table table-hover table-bordered text-center">
        <thead class="table-dark">
            <tr>
                <th>Mã Sản Phẩm</th>
                <th>Tên Sản Phẩm</th>
                <th>Ảnh</th>
                <th>Số Lượng</th>
                <th>Đơn Giá</th>
                <th>Thành Tiền</th>
                <th>Hành Động</th>
            </tr>
        </thead>
        <tbody>
            @foreach (CartItem item in Model.list)
            {
                <tr>
                    <td>@item.MaSP</td>
                    <td>@item.TenSP</td>
                    <td>
                        <img src="@Url.Content("~/HinhAnhSP/MUC HINH ANH CHUNG/" + item.AnhBia)" class="img-thumbnail" style="width:100px; height:100px;" />
                    </td>
                    <td>
                        <div class="d-flex justify-content-center align-items-center">
                            @using (Html.BeginForm("KhachHangGiamMatHang", "KhachHang", FormMethod.Post, new { @class = "d-inline" }))
                            {
                                @Html.AntiForgeryToken()
                                @Html.Hidden("id", item.MaSP)
                                <button type="submit" class="btn btn-outline-danger me-2">-</button>
                            }

                            <span>@item.SoLuong</span>

                            @using (Html.BeginForm("KhachHangTangMatHang", "KhachHang", FormMethod.Post, new { @class = "d-inline" }))
                            {
                                @Html.AntiForgeryToken()
                                @Html.Hidden("id", item.MaSP)
                                <button type="submit" class="btn btn-outline-success ms-2">+</button>
                            }
                        </div>
                    </td>
                    <td>@String.Format("{0:#,###}", item.DonGia) VNĐ</td>
                    <td>@String.Format("{0:#,###}", item.ThanhTien) VNĐ</td>
                    <td>
                        <a href="@Url.Action("KhachHangDetails", "KhachHang", new { id = item.MaSP })" class="btn btn-info me-2">Chi Tiết</a>
                        <a href="@Url.Action("KhachHangXoaGioHang", "KhachHang", new { id = item.MaSP })" class="btn btn-danger">Xóa</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div class="row">
        <div class="col-md-6">
            <h4>Tổng Số Lượng: <span class="text-danger">@((Session["GioHang"] as GioHang)?.TongSLHang() ?? 0)</span></h4>
        </div>
        <div class="col-md-6 text-end">
            <h4>Tổng Thành Tiền: <span class="text-danger">@String.Format("{0:#,###}", (Session["GioHang"] as GioHang)?.TongThanhTien() ?? 0) VNĐ</span></h4>
        </div>
    </div>
    @*<div class="text-end mt-4">
        <a href="@Url.Action("KhachHangDatHang", "KhachHang")" class="btn btn-success btn-lg">Xác Nhận Đặt Hàng</a>
    </div>*@
    <div class="text-end mt-4">
        <a href="javascript:void(0);" onclick="window.history.back();" class="btn btn-secondary btn-lg custom-back-btn me-3">Trở lại danh sách</a>
        <a href="@Url.Action("KhachHangDatHang", "KhachHang")" class="btn btn-primary btn-lg custom-confirm-btn">Xác Nhận Đặt Hàng</a>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-KyZXEAg3QhqLMpG8r+Knujsl5/1hb5O2y0/9S/u6P1E=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js" integrity="sha512-sxYRA1tbbQDCbw4jaJZxwy1HFvHTlJMiMAFpbwcoAEr24vUj7kLsqaMuMKNkGZNoQRy2YNvbO3UKmFz0cvjMTA==" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<style>
    .custom-back-btn {
        font-size: 1rem;
        padding: 10px 20px;
        border-radius: 8px;
        border: 2px solid #6c757d;
        color: #6c757d;
        background-color: transparent;
        transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }

        .custom-back-btn:hover {
            background-color: #6c757d;
            color: #fff;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
        }

    .custom-confirm-btn {
        font-size: 1.2rem;
        padding: 12px 30px;
        border-radius: 8px;
        font-weight: bold;
        color: #fff;
        background-color: #28a745;
        transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
    }

        .custom-confirm-btn:hover {
            background-color: #218838;
            transform: scale(1.05);
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.3);
        }
</style>